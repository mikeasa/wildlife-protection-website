<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.lecheng.protectAnimals.dao.UserDao">
    <select id="getAllUser" resultType="User">
        select  * from protect_animal.user
    </select>
    <select id="getUserBy"  resultType="User" parameterType="User">
        select * from protect_animal.user
        <where>
            <if test="userid!=null">
                userid=#{userid}
            </if>
            <if test="uname!=null">
                and uname=#{uname}
            </if>
            <if test="phonenumber!=null">
                and phonenumber=#{phonenumber}
            </if>
        </where>
    </select>

    <select id="getUser"  resultType="User">
        select userid, uname, upwd, phonenumber, head_img, score, recommend from protect_animal.user where protect_animal.user.uname=#{uname}
    </select>
    <insert id="insertUser" parameterType="User" useGeneratedKeys="true" keyProperty="userid">
       insert into protect_animal.user(uname,upwd,phonenumber) values (#{uname},#{upwd},#{phonenumber})
    </insert>
    <update id="insertRecommend" parameterType="Recommend">
        update protect_animal.user set recommend=#{recommend}
       where userid=#{userid}
    </update>
    <update id="insertUserImg" parameterType="User" >
       update protect_animal.user set protect_animal.user.head_img=#{head_img} where protect_animal.user.userid=#{userid}
    </update>

    <select id="getUserToMyActivity" resultType="User">
        select userid, uname, head_img, score from protect_animal.user where protect_animal.user.userid=#{id}
    </select>

    <select id="getAtMeByMyId" resultType="AtMe">
        select id, myid, otherid, atme, create_time from protect_animal.atme where otherid=#{otherid}
    </select>

    <select id="getUserName" parameterType="int" resultType="string">
        select uname from protect_animal.user where userid=#{userid}
    </select>

    <select id="getFollowOtherUser" resultType="FollowOtherUser">
        select id, user1id, user2id from protect_animal.user_user where user2id=#{user2id}
    </select>

    <select id="getUserImg" parameterType="int" resultType="string">
        select head_img from protect_animal.user where userid=#{userid}
    </select>
</mapper>